
#*********************************************************************
#========================
#Audit-PatchInstalled-ipv6Vuln.ps1
#========================
# Checks if any of the ipv6Vuln patch KBs are installed on the device.
#========================
#*********************************************************************
	
	# Define the list of KB numbers associated with this vulnerability (so we don't have to evaluate for specific OS or feature pack).
	$KBList = "KB5041571","KB5041828","KB5041851","KB5041838","KB5041823","KB5041850","KB5041847","KB5041773","KB5041782","KB5041573","KB5041585","KB5041580","KB5041592","KB5041160","KB5041578"

	# Get the installed patches
	$installedPatches = (Get-HotFix).HotFixID

	# Check if any of the installed patches are in the KB list
	$matchFound = $KBList | Where-Object { $_ -in $installedPatches }

	if ($matchFound) {
		Write-Output "a ipv6 Patch Installed"
	} else {
		Write-Output "b ipv6 Patch NOT installed"
	}
